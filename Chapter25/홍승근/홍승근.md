# 쓰레드는 개발자라면 알아두는 것이 좋아요

## Process와 Thread란?
- JVM이 시작되면 자바 프로세스가 시작한다.
- 이 프로세스 안에서 여러 개의 쓰레드가 수행되지만 여러 프로세스가 공유하는 하나의 쓰레드가 수행되는 일은 절대 없다.
- 어떤 프로세스든 간에 쓰레드가 하나 이상 수행된다.
- 자바 프로세스가 시작되고, main() 메소드가 수행되면서 하나의 쓰레드가 시작된다.
- 쓰레드를 경량 프로세스라고도 부른다.
- 대부분의 작업은 단일 쓰레드보다 다중 쓰레드로 실행하는 것이 더 빠른 시간에 결과를 제공해준다.

## Runnable 인터페이스와 Thread 클래스
> 쓰레드를 생성하는 것은 크게 두 가지로 Runnable 인터페이스 사용과 Thread 클래스를 사용하는 것이 있으며 두 가지 모두 java.lang 패키지에 있다.

### Runnable
- 선언되어 있는 메소드는 run() 메소드 하나이다.
- 쓰레드를 시작하는 메소드는 Thread 클래스의 start()기 때문에 Thread 클래스의 생성자에 Runnable 객체를 추가하여 시작해야 한다.
- 쓰레드 클래스가 다른 클래스를 확장하고 있는 상황에 적합하다.

### Thread
- 쓰레드의 이름을 지정하지 않으면 그 쓰레드의 이름은 Thread-n이 되고 n은 생성된 순서에 따라 증가한다.
- 쓰레드 클래스가 다른 클래스를 확장하지 않는 상황에 적합하다.

## sleep()
> Thread에 있는 static 메소드는 대부분 해당 쓰레드를 위해 존재하는 것이 아닌, JVM에 있는 쓰레드를 관리하기 위한 용도로 사용된다. 하지만 여러 가지 예외 중 하나가 sleep()
> 메소드이다.
- sleep() 메소드란 매개 변수로 넘어온 시간만큼 대기하는 메소드이다.
- sleep() 메소드를 사용할 때에는 핟상 try-catch로 묶어 주어야 한다.
  - sleep() 메소드는 InterruptedException을 던질 수도 있다고 선언되어 있기 때문.

## Thread 클래스의 주요 메소드를 살펴보자
| 리턴 타입               | 메소드 이름 및 매개 변수               | 설명                                            |
|---------------------|------------------------------|-----------------------------------------------|
| void                | run()                        | Thread를 시작하기 위해 구현해야하는 메소드                    |
| long                | getId()                      | 쓰레드의 고유 아이디를 리턴한다. 아이디는 JVM에서 자동으로 생성한다.      |
| String              | getName()                    | 쓰레드의 이름을 리턴한다.                                |
| void                | setName(String name)         | 쓰레드의 이름을 지정한다.                                |
| int                 | getPriority()                | 쓰레드의 우선순위를 리턴한다.                              |
| void                | setPriority(int newPriority) | 쓰레드의 우선순위를 지정한다.                              |
| boolean             | isDaemon()                   | 쓰레드가 데몬 쓰레드인지 확인한다.                           |
| void                | setDaemon(boolean on)        | 쓰레드를 데몬 쓰레드로 변경한다. 단 쓰레드가 시작되기 전에 변경하여야 적용된다. |
| StackTraceElement[] | getStackTrace()              | 쓰레드의 스택 정보를 확인한다.                             |
| Thread.State        | getState()                   | 쓰레드의 상태를 확인한다.                                |
| ThreadGroup         | getThreadGroup()             | 쓰레드의 그룹을 확인한다.                                | 

### DaemonThread
- 사용자 쓰레드는 JVM이 해당 쓰레드가 끝날 때까지 기다린다.
- 어떤 쓰레드를 데몬으로 지정하면, 그 쓰레드가 수행되고 있든 없든 JVM이 끝날 수 있다.
  - 단, 해당 쓰레드가 시작하기 전에 데몬 쓰레드가 지정되어야한다.
  - 쓰레드가 싲가한 다음에는 데몬으로 지정할 수 없다.
- 데몬 쓰레드는 해당 쓰레드가 종료되지 않아도 다른 실행중인 일반 쓰레드가 없다면 멈춘다.

## synchronized
- 어떤 클래스가 메소드가 쓰레드에 안전하려면, synchronized를 사용해야만 한다.
    - synchronized가 선언되어 있으면 하나의 쓰레드만 수행할 수 있게 되기 때문이다.
- 방법으로는 메소드 자체를 synchronized로 선언하는 방법, 메소드 내의 특정 문장만 synchronized로 감싸는 방법이 있다.
- synchronized는 여러 쓰레드에서 하나의 객체에 있는 인스턴스 변수를 동시에 처리할 때 발생할 수 있는 문제를 해결하기 위해 필요한 것이다. 
 
## 쓰레드를 통제하는 메소드
| 리턴 타입        | 메소드 이름 및 매개 변수               | 설명                                                                         |
|--------------|------------------------------|----------------------------------------------------------------------------|
| Thread.State | getState()                   | 쓰레드의 현재 상태를 반환하는 메소드                                                       |
| void         | join()                       | 수행중인 쓰레드가 중지할 때까지 기다린다. 쓰레드의 수행이 중지되면 join() 다음 라인에 있는 코드를 실행한다.           |
| void         | join(long millis)            | 매개 변수에 지정된 시간만큼(1/1.000초) 대기한다.                                            |
| void         | join(long millis, int nanos) | 첫 번째 매개 변수에 지정된 시간 (1/1.000초) + 두번째 매개변수에 지정된 시간(1/1.000.000.000초)만큼 대기한다. |
| void         | interrupt()                  | 수행중인 쓰레드에 중지 요청을 한다.

### getState()
> getState() 메소드에서 리턴하는 Thread.State enum 클래스의 상수 목록은 다음과 같다.
- NEW : 쓰레드가 객체가 생성된 상태 
- RUNNABLE : 쓰레드가 실행중인 상태
- BLOCKED : 쓰레드가 실행 중지 상태이며, 모니터 락이 풀리기를 기다리는 상태
- WAITING : 쓰레드가 대기중인 상태
- TIME_WAITING : 특정 시간만큼 쓰레드가 대기 중인 상태
- TERMINATED : 쓰레드가 종료된 상태

### join()
- join() 메소드는 해당 쓰레드가 종료될 때까지 기다린다.
- 첫 번째 매개 변수가 음수이거나, 두 번째 매개 변수가 0 ~ 999,999 사이 값이 아니면 IllegalArgumentException 예외가 발생한다.

### interrupt()
- interrupt() 메소드는 현재 수행중인 쓰레드를 중단시킨다.
  - 그냥 중단이 아닌 InterruptedException을 발생 시킴.
- 쓰레드가 시작하기 전이나, 종료된 상태에 interrupt() 메소드를 호출하면 예외나 에러 없이 다음 문장으로 넘어간다.

## Object 클래스에 선언된 쓰레드와 관련있는 메소드들

| 리턴 타입 | 메소드 이름 및 매개 변수                | 설명                                                               |
|-------|-------------------------------|------------------------------------------------------------------|
| void  | wait()                        | 다른 쓰레드가 Object 객체에 대한 notify() 메소드나 notifyAll 메소드를 호출할 때까지 대기한다. |
| void  | wait(long timeout)            | wait() 메소드와 동일한 기능을 제공한다. 매개변수에 지정된 시간만큼 대기한다.(1/1000초)단위        |
| void  | wait(long timeout, int nanos) | wait() 메소드와 동일한 기능을 제공한다. timeout(밀리초) + nanos(나노초) 만큼 대기한다.     |
| void  | notify()                      | Object 객체의 모니터에 대기하고 있는 단일 쓰레드를 꺠운다.                             |
| void  | notifyAll()                   | Object 객체의 모니터에 대기하고 있는 모든 쓰레드를 깨운다.  

## ThreadGroup에서 제공하는 메소드들
> ThreadGroup은 쓰레드의 관리를 용이하게 하기 위한 클래스다. 만약 Thread 클래스가 없으면 용도가 다른 여러 쓰레드를 관리하기 어려울 것이다.
- enumerate() : 해당 쓰레드 그룹에 포함된 쓰레드나 쓰레드 그룹의 목록을 매개 변수로 넘어온 배열에 담는다.
  - 리턴값은 배열에 저장된 쓰레드의 개수
- activeCount() : 현재 싱행중인 쓰레드의 개수를 리턴 
